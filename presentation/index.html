<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>reveal.js – The HTML Presentation Framework</title>

		<meta name="description" content="A framework for easily creating beautiful presentations using HTML">
		<meta name="author" content="Hakim El Hattab">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/moon.css" id="theme">

		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
		
		<style>
			img.displayimage {
				max-height: 500px;
				max-width: 700px;
			}
		</style>
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h1>Interactive Web Maps</h1>
					<h3>Bring maps in your web app</h3>
					<p>
						<small>Created by Teodor Naydenov and Hristo Yankov</small>
					</p>
				</section>

				<section>
					<h2>Agenda</h2>
						<ul>
							<li>Technology overview</li>
							<li>Q&A session</li>
							<li>Break</li>
							<li>Hands on</li>
						</ul>
				</section>
				<section>
					<h2>What this workshop is:</h2>
					<ul>
						<li>interactive activity</li>
						<li>brief introduction to GIS</li>
						<li>taste what can be done with the help of JS map library</li>
						<li>chance to have some fun</li>
					</ul>
				</section>
				<section>
					<h2>What this workshop is not:</h2>
					<ul>
						<li>detailed reference of GIS</li>
						<li>refined workshop with shiny examples</li>
						<li>boring lecture to let you have a nap</li>
					</ul>
				</section>
				<section>
					<section>
						<h2>What is a map?</h2>
						<img class="displayimage" src="images/map2.jpg">
					</section>
					<section>
						<h3>Road map</h3>
						<img class="displayimage" src="images/sofiamap.png">
					</section>
					<section>
						<h3>World map</h3>
						<img class="displayimage" src="images/worldmap.jpg">
					</section>
					<section>
						<h3>Population map</h3>
						<img class="displayimage" src="images/populationmap_europe.gif">
					</section>
					<section>
						<h3>And a map is ...</h3>
						<p>Collection of features (objects) with geographical locations,
						   projected on flat surface. 
						</p>
					</section>
				</section>
				
				<section>
					<section>
						<h2>What is interactive map?</h2>
						<img class="displaymapimage" src="images/interactive_map2.png">
					</section>
					<section>
						<h2>Virus tracing with interactive map</h2>
						<img class="displaymapimage" src="images/interactive_map3.png">
					</section>
					<section>
						<h2>Want to see antoher shiny example in action...</h2>
						<a class="fragment" href="http://d3.artzub.com/wbca/" target="_blank">WorldBank Contract Awards</a><br>
                        <a class="fragment" href="http://earth.nullschool.net/" target="_blank">Eart weather conditions</a>
					</section>
					<section>
						<h2>Common properties of interactive map</h2>
						<ul>
							<li>position & zoom controls</li>
							<li>layer controls</li>
							<li>markers</li>
							<li>search functionality</li>
							<li>...</li>
							<li>data to be displayed</li>
						</ul>
					</section>
				</section>
				
				<section>
					<section>
						<h2>What app can benefit from interactive maps</h2>
						<p>Any app that operates with data related to geography locations</p>
					</section>
					<section>
						<h2>How a map can change your app?</h2>
						<a class="fragment" href="http://kvartali.info/" target="_blank">Neighborhoods in Sofia</a>
						<p class="fragment">Any ideas to make it better?</p>
					</section>
				</section>
				
				<section>
					<section>
						<h2>Bird eye over map technology stack</h2>
						<img class="displayimage" src="images/technology_stack.png">
					</section>
					<section>
						<h3>Data</h3>
						<p>Not an image. For an example a street on road map
						can be represented as polyline with several attributes.
						</p>
						<img src="images/line-vector.png">
					</section>
					<section>
						<h3>Rendering</h3>
						<p>Convert data to an image. Each feature is "drawn"
						to a layer of the map.</p>
						<p>Drawing rules for each feature type are configured.
						These can be: line width, line color, text, etc.</p>
					</section>
					<section>
						<h3>Rendering</h3>
						<img class="displayimage" src="images/line_2_street.png">
					</section>
					<section>
						<h3>Layers</h3>
						<p>Each layer contains set of features. Layers are placed on top of each other.</p>
						<img src="images/layers.jpg">
					</section>
					<section>
						<h3>Layers</h3>
						<img src="images/layers2.jpg">
					</section>
					<section>
						<h3>Tile map / Slippy map</h3>
						<img src="images/tiles.jpg">
					</section>
					<section>
						<h3>In the browser</h3>
						<img class="displayimage" src="images/leaflet.png">
					</section>
				</section>
				
				<section>
					<section>
						<h2>Geospatial data</h2>
						<h3>Definition</h3>
						<p>Data that identifies geographic locations of features on Earth. 
							These can be natural or constructed features, oceans, continents, 
							rivers, cities, restaurants, stores, etc.</p>
						<p>Geospatial data, GIS data or geodata has explicit geographic positioning 
							information included within it.</p>
					</section>
					<section>
						<h3>Raster geospatial data</h3>
						<p>In raster data the entire area of the map is subdivided into a grid of tiny cells. 
							A value is stored in each of these cells to represent the nature of whatever 
							is present at the corresponding location on the ground. Raster data can be 
							thought of as a matrix of values.</p>
						<p>Examples for raster geospatial data:</p>
						<ul>
							<li>Satellite image</li>
							<li>Digital Elevation Model (DEM)</li>
						</ul>
					</section>
					<section>
						<h3>Satellite data</h3>
						<img src="images/satelite_image.jpg">
					</section>
					<section>
						<h3>Digital elevation model</h3>
						<img src="images/dem.gif">
					</section>
					<section>
						<h3>Raster geospatial data also includes</h3>
						<p>Beside raster band, raster geospatial data includes
						coordinate system and transformation.</p>
						<img src="images/raster_data_transform.gif">
					</section>
					<section>
						<h3>Vector data</h3>
						<p>In vector data the features are recorded one by one, with shape being defined by 
							the numerical values of the pairs of xy coordinates.</p>
						<ul>
							<li>A point is defined by a single pair of coordinate values</li>
							<li>A line is defined by a sequence of coordinate pairs defining the 
								points through which the line is drawn</li>
							<li>An area (polygon) is defined in a similar way, only with the 
								first and last points joined to make a complete enclosure. </li>
						</ul>
					</section>
					<section>
						<h3>Vector data</h3>
						<img src="images/vector_daya.gif">
					</section>
					<section>
						<h3>Feature</h3>
						<p>A feature is representation of real world object on a map.</p>
						<ul>
							<li>geometry - spatial representation, which consists of points, lines,
							polygons, multipoints, multilines, etc</li>
							<li>attributes - additional properties related to corresponding feature</li>
						</ul>
						<p>Each feature has a type (class), which determines type of geometry and set of 
						attributes. Features with same class can be combined into collections.</p>
					</section>
					<section>
						<h3>Feature</h3>
						<img src="images/feature.gif">
					</section>
				</section>
				
				<section>
					<section>
						<h2>File formats</h2>
						<ul>
							<li>Shapefiles</li>
							<li>GeoJSON</li>
							<li>KML</li>
							<li>OSM</li>
						</ul>
					</section>
					<section>
						<h3>Shapefiles</h3>
						<p>Binary format developed by ESRI. The main file types have the suffixes .shp, .shx and .dbf, 
							but there are several more.</p>
						<p>Contains vector data organized as features placed in layers. Each feature has geometry and 
						other attributes.</p>
					</section>
					<section>
						<h3>Work with shapefiles</h3>
						<ul>
							<li>ArcGIS suite</li>
							<li>QGIS</li>
							<li>GDAL/OGR libraries, ogr2ogr utility</li>
						</ul>
					</section>
					<section>
						<h3>GeoJSON</h3>
						<p>GeoJSON is a format for encoding a variety of geographic data structures.</p>
						<p>Based on well known JSON file format.</p>
					</section>
					<section>
						<h3>Some taste of GeoJSON</h3>
						<pre><code class="hljs" data-trim contenteditable>
{
  "type": "Feature",
  "geometry": {
	"type": "Point",
	"coordinates": [125.6, 10.1]
  },
  "properties": {
	"name": "Dinagat Islands"
  }
}
						</code></pre>
					</section>
					<section>
						<h3>KML</h3>
						<p>Developed by Keyhole, later bought by Google. The file format is based
						on XML. The file contained both: geographic data and style, which instruct browser
						how to render data.</p>
						<p>KML is now open standard.</p>
					</section>
					<section>
						<h3>WKT and WKB</h3>
						<ul>
							<li>POINT(15 20)</li>
							<li>LINESTRING(0 0, 10 10, 20 25, 50 60)</li>
							<li>GEOMETRYCOLLECTION(POINT(10 10), POINT(30 30), LINESTRING(15 15, 20 20))</li>
						</ul>
					</section>
				</section>
				<section>
					<section>
						<h3>Spatial Databases</h3>
						<p>Spatially enabled database is database system, which is aware of the notion of space
						and direct interaction with spatial objects and concepts</p>
					</section>
					<section>
						<h3>Spatial data types & indexes</h3>
						<p>Spatial databases can store points, lines, polygons, etc directly 
							in the database in the form of geometry columns.</p>
						<p>Spatial databases support index on geometry columns, which 
							dramatically speeds up lookup operations</p>
					</section>
					<section>
						<h3>Spatial data types in DB table</h3>
						<img src="images/SpatialDB_table.jpg">
					</section>
					<section>
						<h3>Spatial operators/functions</h3>
						<p>Spatially enabled databases support large set of operators, which can be used
						in queries such as: contains, intersects, crosses, closest point and many more.</p>
					</section>
					<section>
						<h3>Spatial databases</h3>
						<ul>
							<li>PostGIS (PostgreSQL)</li>
							<li>MySQL</li>
							<li>SpatiaLite (SQLite)</li>
							<li>MongoDB</li>
							<li>Oracle</li>
							<li>MS SQL Server</li>
							<li>CartoDB (SaaS, based on PostGIS)</li>
						</ul>
					</section>
					<section>
						<h3>Reasons to use spatial database</h3>
						<p>Files with spatial data allow effective storage of large amount of information, 
						but are very inefficient regarding finding any interaction between features</p>
						<p>Spatial databases can save the day for any GIS application, which needs to 
						operate effectively with features. Typical example: find all features, which are
						contained in rectangle with some coordinates.
						</p>
					</section>
					<section>
						<h3>Get all features inside a rectangle</h3>
						<img class="displayimage" src="images/SpatialDB_bbox.jpg">
					</section>
					<section>
						<h3>Find a route</h3>
						<img class="displayimage" src="images/SpatialDB_route.jpg">
					</section>
				</section>
				<section>
					<h3>Sources of geospatial data</h3>
					<ul>
						<li>Openstreet Map</li>
						<li>Natural Earth</li>
						<li>World Borders Dataset</li>
						<li>GeoHive</li>
						<li>OpenWeatherMap (API)</li>
						<li>Landsat</li>
						<li>Global Land One-kilometer Base Elevation (GLOBE)</li>
					</ul>
					<p>
					Have a look at Wikipedia: 
					<a target="_blank" href="https://en.wikipedia.org/wiki/List_of_GIS_data_sources">List of GIS data sources</a>
				</section>
				<section>
					<section>
						<h3>Coordinates and projections</h3>
						<p>Geographical coordinate system is method for describing geographical location
						on Earth's surface, using measures of latitude and longitude.</p>
						<img src="images/geo_coordinate.gif">
					</section>
					<section>
						<h3>Datum</h3>
						<p>Datum is mathematical model that approximates the shape of the Earth, which is quite uneven and complex. 
						Datum is used along with coordinate system for accurate position, length and area calculations.</p>
						<a target="_blank" href="https://www.youtube.com/watch?v=xKGlMp__jog">A Simple Explanation of Datum (Youtube)</a>
						<p>One of the most widely used global datum is WGS84.</p>
					</section>
					<section>
						<h3>Datum</h3>
						<img src="images/Different_datums.png">
					</section>
					<section>
						<h3>Projection</h3>
						A projection is a series of transformations which convert the location of points on a curved 
						surface(i.e. datum) to locations on flat plane (i.e. transforms coordinates 
						from one coordinate reference system to another).
					</section>
					<section>
						<h3>Different projections</h3>
						<img class="displayimage" src="images/projection_families.png">
					</section>
					<section>
						<h3>Geographic projection</h3>
						A.k.a. equirectangular projection or plate carrée projection.
						<img class="displayimage" src="images/Equirectangular_projection_SW.jpg">
					</section>
					<section>
						<h3>WGS84 Web Mercator</h3>
						<p>Defacto standard in web mapping. EPSG code: EPSG:3857.</p>
						<img class="displayimage" src="images/web_mercator_projection.jpg">
					</section>
					<section>
						<h3>Projection distortion</h3>
						<p>Each projection from Earth's surface to flat surface impose some distortions.</p>
						<img class="displayimage" src="images/Tissot_mercator.png">
					</section>
					<section>
						<h3>Projection distortion</h3>
						<img class="displayimage" src="images/Tissot_equirectangular.png">
					</section>
				</section>
				<section>
					<section>
						<h3>Rendering</h3>
						<p>Raw geospatial data can be meaningless for human eye. Rendering
						is the process, which transforms raw data to another form (i.e. image),
						which can be understood by humans.</p>
						<p>Rendering can be quite complex process, depending on the nature
						of the data and desired map look and feel.</p>
					</section>
					<section>
						<h3>Rendering flow</h3>
						<p>The inputs are</p>
						<ul>
							<li>geospatial data - vector or raster, described in some formats. 
								Spatial reference (i.e. coordinate system and datum) are integral 
								part of data.</li>
							<li>configuration - determines how features will be drawn on the image,
								i.e. colors, brushes, fonts, etc. It is common to place different
								feature types in separate layers.</li>
							<li>map properties - projection, envelope, file format.</li>
						</ul>
					</section>
					<section>
						<h3>Rendering flow diagram</h3>
						<img src="images/Rendering%20flow.png">
					</section>
					<section>
						<h3>Where rendering happens</h3>
						<p>Generally it depends on type of application. For web maps,
						we have following options.</p>
						<ul>
							<li>on the server - creating the base layer, which very complex
							and includes a lot of features.</li>
							<li>browser - with the help of javascript library. Used to 
							provide additional information on the top of the base layer.</li>
						</ul>
						<p>
						For some interactive web maps, which lack base layer, rendering can be 
						performed entirely in the browser.</p>
					</section>
					<section>
						<h3>Base layer and other information</h3>
						<img src="images/baselayer_overlay.png">
					</section>
					<section>
						<h3>Base layer and other information</h3>
						<img src="images/baselayer_overlay2.png">
					</section>
					<section>
						<h3>Rendering on the server</h3>
						<p>Appropriate for complex maps, which includes a lot of features. 
							Most popular toolkits:</p>
						<ul>
							<li>Mapnik - probably the famous rendering toolkit. It is written in C++,
								but has bindings for Pythons and Javascript</li>
							<li>Geotools - Java based GIS toolkit. Besides rendering a map, it offers
							a bunch of other tools for manipulating GIS data</li>
						</ul>
					</section>
					<section>
						<h3>Mapnik architecture</h3>
						<img class="displayimage" src="images/mapnik.jpg">
					</section>
					<section>
						<h3>Mapnik datasources</h3>
						<p>Mapnik is very flexible regarding sources of data. They can be:</p>
						<ul>
							<li>Shapefile</li>
							<li>PostGIS/SQLite</li>
							<li>OSM (XML)</li>
							<li>Raster image</li>
						</ul>
					</section>
					<section>
						<h3>Rendering in the browser</h3>
						<p>
						Drawing is performed by javascript library. The geospatial data comes 
						in GeoJSON, CSV, WKT or other "micro" format.</p>
						<p>Relatively easy to configure, but has limitations 
						regarding data amount and performance.</p>	
					</section>
					<section>
						<h3>JS libraries</h3>
						<ul>
							<li>Google Maps API</li>
							<li>Leaflet</li>
							<li>Open Layers</li>
							<li>D3js</li>
						</ul>
					</section>
					<section>
						<h3>JS libraries capabilities</h3>
						<p>Despite of being simpler than server renderer toolkits, JS client libraries
						give a lot of functionality for developer including manipulation of features,
						coordinates, projections, renderer styles and many more.</p>
						<p>They allows to use base layer, rendered on the server plus additional features,
						rendered in the browser.</p>
						<p>JS libraries are inevitable for every kind of interactivity of the web map!</p>
					</section>
				</section>
				<section>
					<section>
						<h3>Map tiling</h3>
						<p>The continuous image of the world is divided to small square images called tiles.</p>
						<img src="images/map_tiles.png">
					</section>
					<section>
						<h3>Zoom level</h3>
						<ul>
							<li>Zoom in - more details, but smaller area is shown.</li>
							<li>Zoom out - less detail, but larger area is shown.</li>
						</ul>
						<p>Map scale depends not only on zoom level, but on monitor DPI as well.</p>
					</section>
					<section>
						<h3>Tile pyramid</h3>
						<p>For each map "zoom level, there is separate layer of tiles</p>
						<img class="displayimage" src="images/TilePyramid.jpg">
					</section>
					<section>
						<h3>Tile numbering</h3>
						<p>Each tile has coordinates, which depends on zoom level.
						For zoom level 2, tiles look like this:</p>
						<img class="displayimage" src="images/tile_coordinates.png">
					</section>
					<section>
						<h3>Tile caching</h3>
						<p>Tile rendering is relatively cpu intensive process. Since most geospatial
						data remains unchanged for a long period of time, it is effective to cache
						rendered tiles.</p>
					</section>
					<section>
						<h3>Protocols for tile transfer</h3>
						<p>Currently, the mostly used protocol for transfering tiles from server to client
						is HTTP with REST API. The common URL pattern looks like:</p>
						<pre><code class="hljs" data-trim contenteditable>
http://{tile_server}/{z}/{x}/{y}.png
						</code></pre>
						where:<br>
						{z} = zoom level<br>
						{x},{y} = tile number 
					</section>
					<section>
						<h3>End to end server solutions</h3>
						<ul>
							<li>Geoserver</li>
							<li>Mapnik + TileCache</li>
							<li>Mapserver</li>
						</ul>
					</section>
				</section>
				<section>
					<section>
						<h3>Client side</h3>
						<p>Browser is powerful exection environment, capabable of interpreting HTML/CSS and 
						JavaScript code. Modern JS engines such as V8 (Chrome) and Rhino(Mozilla) provides
						exceptional performance.</p>
					</section>
					<section>
						<h3>Interactive maps in the browser</h3>
						<p>Implementation of interactive maps is not possible without using appropriate JS 
							map library which:</p>
						<ul>
							<li>Handles all user controls including zooming, panning, enabling additonal layers, etc.</li>
							<li>Requesting corresponding tiles from the server</li>
						</ul>
					</section>
					<section>
						<h3>Additional functionalities</h3>
						<p>Modern JS map libraries support many more functionalities, including: </p>
						<ul>
							<li>tile caching</li>
							<li>markers</li>
							<li>overlay</li>
							<li>drawing of different shapes</li>
							<li>...</li>
						</ul>
					</section>
					<section>
						<h3>JS map libraries</h3>
						<ul>
							<li>Google maps API</li>
							<li>openlayers</li>
							<li>leaflet</li>
						</ul>
						<p>One more truly amazing library is D3js. Not designed to deal with maps initially,
						now it has great support dealing with GeoJSON features and tiles.</p>
					</section>
					<section>
						<h3>Leaflet(js)</h3>
						<img src="images/leaflet_logo.png">
						<p>Leaflet is one of the leading JS libraries for interactive maps. It's simplicity and performance make
						it an excellent choice for web and mobile apps with map support. </p>
					</section>
					<section>
						<h3>Leaflet features</h3>
						<ul>
							<li>Raster layers: tiles and WMS</li>
							<li>Vector layers: polylines, polygons, circles, and popups</li>
							<li>Markers and popups</li>
							<li>GeoJSON data</li>
							<li>Browser events handling</li>
							<li>Heatmaps and choroplets</li>
						</ul>
					</section>
					<section>
						<h3>Leaflet in action</h3>
						<img class="displayimage" src="images/leaflet_in_action.png">
					</section>
					<section>
						<h3>Heatmaps with Leaflet</h3>
						<img class="displayimage" src="images/leaflet_heatmap.png">
					</section>
					<section>
						<h3>Choroplets with Leaflet</h3>
						<img class="displayimage" src="images/leaflet-choropleth.png">
					</section>
				</section>
				<section>
					<h3>Questions</h3>
					<p>???</p>
				</section>
				<section>
					<h3>The End</h3>
					<p>Thank you!</p>
				</section>
			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>

			// Full list of configuration options available at:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// Optional reveal.js plugins
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>
